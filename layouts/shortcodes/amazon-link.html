{{- $url := .Get 0 -}}
{{- $text := .Get 1 -}}
{{- $price := .Get 2 -}}
{{- $tag := "ateliercboulet-20" -}}

{{- if not (strings.Contains $url "tag=") -}}
  {{- if strings.Contains $url "?" -}}
    {{- $url = printf "%s&tag=%s" $url $tag -}}
  {{- else -}}
    {{- $url = printf "%s?tag=%s" $url $tag -}}
  {{- end -}}
{{- end -}}

<a href="{{ $url }}" target="_blank" rel="noopener noreferrer sponsored" class="amazon-affiliate-link">
  <span class="link-text">{{ $text }}</span>
  {{- if $price -}}
    <span class="price-tag">{{ $price }}</span>
  {{- end -}}
  <span class="amazon-badge">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="amazon-icon">
      <path d="M.045 18.02c.072-.116.187-.124.348-.022 3.636 2.11 7.594 3.166 11.87 3.166 2.852 0 5.668-.533 8.447-1.595l.315-.14c.138-.06.234-.1.293-.13.226-.088.39-.046.525.13.12.174.09.336-.12.48-.256.19-.6.41-1.006.654-1.244.743-2.64 1.316-4.185 1.726-1.53.406-3.045.61-4.516.61-2.265 0-4.41-.396-6.435-1.187-2.02-.794-3.82-1.91-5.43-3.35-.1-.074-.15-.15-.15-.22 0-.047.02-.09.05-.13zm6.565-6.218c0-1.005.247-1.863.743-2.577.495-.71 1.17-1.25 2.04-1.615.796-.335 1.756-.575 2.912-.72.39-.046 1.033-.103 1.92-.174v-.37c0-.93-.105-1.558-.3-1.875-.302-.43-.78-.65-1.44-.65h-.182c-.48.046-.896.196-1.246.46-.35.27-.575.63-.675 1.096-.06.3-.206.465-.435.51l-2.52-.315c-.248-.06-.372-.18-.372-.39 0-.046.007-.09.022-.15.247-1.29.855-2.25 1.82-2.88.976-.616 2.1-.975 3.39-1.05h.54c1.65 0 2.957.434 3.888 1.29.135.15.27.3.405.48.12.165.224.314.283.45.075.134.15.33.195.585.045.24.06.435.06.585v5.24c0 .38.116.9.345 1.56.226.66.35 1.12.35 1.365v.12c0 .18-.115.33-.325.417l-2.685 1.74c-.21.136-.406.195-.6.18-.18 0-.39-.06-.63-.21-.24-.15-.465-.315-.66-.51-.196-.18-.38-.405-.538-.63-.04-.06-.08-.106-.122-.15-.427.51-.93.918-1.487 1.2-.556.283-1.275.426-2.16.426-.838 0-1.666-.226-2.49-.69-.824-.465-1.477-1.12-1.972-1.965-.495-.846-.737-1.797-.737-2.873zm3.42-.51c0 .917.21 1.606.63 2.07.42.465 1.006.69 1.752.69.3 0 .63-.045.99-.135.36-.09.66-.217.87-.375.226-.135.466-.36.72-.664.255-.285.435-.63.525-.976.106-.42.166-.9.166-1.44v-.765c-1.38.106-2.37.255-2.97.435-.6.194-1.05.48-1.365.84-.3.376-.45.855-.45 1.424z"/>
    </svg>
    Amazon
  </span>
</a>